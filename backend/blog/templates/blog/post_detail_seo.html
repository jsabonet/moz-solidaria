{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    {# Título SEO #}
    <title>{{ post.meta_title|default:post.title }} | Moz Solidária</title>
    
    {# Meta tags básicas #}
    <meta name="description" content="{{ post.meta_description|default:post.excerpt }}">
    {% if post.meta_keywords %}
    <meta name="keywords" content="{{ post.meta_keywords }}">
    {% endif %}
    {% if post.canonical_url %}
    <link rel="canonical" href="{{ post.canonical_url }}">
    {% else %}
    <link rel="canonical" href="{{ request.build_absolute_uri:post.get_absolute_url }}">
    {% endif %}
    {% if post.robots_meta %}
    <meta name="robots" content="{{ post.robots_meta }}">
    {% else %}
    <meta name="robots" content="index,follow">
    {% endif %}
    
    {# Open Graph tags #}
    <meta property="og:type" content="article">
    <meta property="og:title" content="{{ post.og_title|default:post.title }}">
    <meta property="og:description" content="{{ post.og_description|default:post.meta_description|default:post.excerpt }}">
    <meta property="og:url" content="{{ request.build_absolute_uri:post.get_absolute_url }}">
    <meta property="og:site_name" content="Moz Solidária">
    {% if post.og_image %}
    <meta property="og:image" content="{{ request.build_absolute_uri:post.og_image.url }}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    {% elif post.featured_image %}
    <meta property="og:image" content="{{ request.build_absolute_uri:post.featured_image.url }}">
    {% endif %}
    <meta property="article:published_time" content="{{ post.published_at|default:post.created_at|date:'c' }}">
    <meta property="article:modified_time" content="{{ post.updated_at|date:'c' }}">
    <meta property="article:author" content="{{ post.author.get_full_name|default:post.author.username }}">
    {% if post.category %}
    <meta property="article:section" content="{{ post.category.name }}">
    {% endif %}
    {% for tag in post.tags.all %}
    <meta property="article:tag" content="{{ tag.name }}">
    {% endfor %}
    
    {# Twitter Card tags #}
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{{ post.og_title|default:post.title }}">
    <meta name="twitter:description" content="{{ post.og_description|default:post.meta_description|default:post.excerpt }}">
    <meta name="twitter:site" content="@mozsolidaria">
    {% if post.og_image %}
    <meta name="twitter:image" content="{{ request.build_absolute_uri:post.og_image.url }}">
    {% elif post.featured_image %}
    <meta name="twitter:image" content="{{ request.build_absolute_uri:post.featured_image.url }}">
    {% endif %}
    
    {# Schema.org structured data #}
    <script type="application/ld+json">
    {{ post.get_schema_data|safe }}
    </script>
    
    {# Breadcrumb schema (se usando template tag customizada) #}
    {% if breadcrumb_schema %}
    <script type="application/ld+json">
    {{ breadcrumb_schema|safe }}
    </script>
    {% endif %}
    
    {# FAQ schema (se houver FAQs extraídos do conteúdo) #}
    {% if faq_schema %}
    <script type="application/ld+json">
    {{ faq_schema|safe }}
    </script>
    {% endif %}
    
    {# CSS e outros recursos #}
    <link rel="stylesheet" href="{% static 'css/blog.css' %}">
</head>
<body>
    <article>
        <header>
            {# Breadcrumb para navegação #}
            <nav aria-label="Breadcrumb">
                <ol>
                    <li><a href="/">Home</a></li>
                    <li><a href="/blog/">Blog</a></li>
                    {% if post.category %}
                    <li><a href="{{ post.category.get_absolute_url }}">{{ post.category.name }}</a></li>
                    {% endif %}
                    <li aria-current="page">{{ post.title }}</li>
                </ol>
            </nav>
            
            <h1>{{ post.title }}</h1>
            
            {# Metadados do artigo #}
            <div class="article-meta">
                <time datetime="{{ post.published_at|default:post.created_at|date:'c' }}">
                    {{ post.published_at|default:post.created_at|date:'d \d\e F \d\e Y' }}
                </time>
                <span>por {{ post.author.get_full_name|default:post.author.username }}</span>
                {% if post.read_time %}
                <span>{{ post.read_time }} min de leitura</span>
                {% endif %}
                {% if post.category %}
                <a href="{{ post.category.get_absolute_url }}">{{ post.category.name }}</a>
                {% endif %}
            </div>
            
            {# Imagem em destaque com créditos #}
            {% if post.featured_image %}
            <figure class="featured-image">
                <img src="{{ post.featured_image.url }}" 
                     alt="{{ post.featured_image_caption|default:post.title }}"
                     loading="lazy">
                {% if post.featured_image_caption or post.featured_image_credit %}
                <figcaption>
                    {% if post.featured_image_caption %}
                    <span class="caption">{{ post.featured_image_caption }}</span>
                    {% endif %}
                    {% if post.featured_image_credit %}
                    <span class="credit">
                        {% if post.featured_image_source_url %}
                        <a href="{{ post.featured_image_source_url }}" target="_blank" rel="noopener">
                            {{ post.featured_image_credit }}
                        </a>
                        {% else %}
                        {{ post.featured_image_credit }}
                        {% endif %}
                    </span>
                    {% endif %}
                </figcaption>
                {% endif %}
            </figure>
            {% endif %}
            
            {# Resumo/Excerpt #}
            {% if post.excerpt %}
            <div class="excerpt">
                {{ post.excerpt }}
            </div>
            {% endif %}
        </header>
        
        {# Conteúdo principal #}
        <div class="content">
            {{ post.content|safe }}
        </div>
        
        {# Tags #}
        {% if post.tags.all %}
        <footer class="article-footer">
            <div class="tags">
                <strong>Tags:</strong>
                {% for tag in post.tags.all %}
                <a href="{{ tag.get_absolute_url }}" rel="tag">{{ tag.name }}</a>
                {% endfor %}
            </div>
        </footer>
        {% endif %}
    </article>
    
    {# Botões de compartilhamento social #}
    <div class="social-sharing">
        <h3>Compartilhe este artigo</h3>
        <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri:post.get_absolute_url|urlencode }}" 
           target="_blank" rel="noopener">
            Compartilhar no Facebook
        </a>
        <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri:post.get_absolute_url|urlencode }}&text={{ post.title|urlencode }}" 
           target="_blank" rel="noopener">
            Compartilhar no Twitter
        </a>
        <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri:post.get_absolute_url|urlencode }}" 
           target="_blank" rel="noopener">
            Compartilhar no LinkedIn
        </a>
        <a href="whatsapp://send?text={{ post.title|urlencode }} {{ request.build_absolute_uri:post.get_absolute_url|urlencode }}" 
           target="_blank" rel="noopener">
            Compartilhar no WhatsApp
        </a>
    </div>
</body>
</html>
